!function(){window.Paginator={}}(),function(){Paginator.ComponentSettings=function(n){var e;return e={padding:n.padding,paperGap:n.paperGap}}}(),function(){Paginator.Settings=function(n){var e;return e={component:new Paginator.ComponentSettings(n)}}}(),function(){Paginator.Renderer=function(n){function e(n){return n.hasClass("page-block")||n.hasClass("page-break")}function t(n){function t(n,a){var i=n.children();return!(i.length<1)&&(i.each(function(){var n=$(this);a=e(n)||t(n,a)}),a)}var a=!1,i=n.children();return!(i.length<1)&&(i.each(function(){var n=$(this);a=e(n)||t(n,a)}),a)}function a(a){function i(n){var a=n.children();return!t(n)&&e(n)?(d+=1,n.parent().data("order",d),n.data("modelParent",n.parent()),void s.unshift(n)):void a.each(function(){var n=$(this);i(n)})}function r(){s.forEach(function(e){console.log(e.data("order")),o[n._lastPageNumber]||(o[n._lastPageNumber]=new Paginator.Page(n,n._lastPageNumber),n.$$view.append(o[n._lastPageNumber])),o[n._lastPageNumber].$margin.append(e),(e.hasClass("page-break")||o[n._lastPageNumber].needsBreaking())&&(n._lastPageNumber++,o[n._lastPageNumber]||(o[n._lastPageNumber]=new Paginator.Page(n,n._lastPageNumber),n.$$view.append(o[n._lastPageNumber])),o[n._lastPageNumber]=o[n._lastPageNumber]||new Paginator.Page(n,n._lastPageNumber),o[n._lastPageNumber].$margin.append(e))})}var d=-1,s=[];i(a),setTimeout(function(){r()})}function i(){n._lastPageNumber=0,o.forEach(function(n){n.removeAttr("hidden")})}function r(){o.forEach(function(n){n.data("pageNumber")<1||!n.isBlank()||n.attr("hidden","hidden")})}var o=[];this.render=function(){n.data("isRendering",!0),i(),setTimeout(function(){n.$$model.children(".content").children().each(function(){a($(this))}),setTimeout(function(){r(),n.data("isRendering",!1)})})}}}(),function(){Paginator.Page=function(n,e){var t,a;return a=n.data("settings"),t=$("<div>"),t.$content=$("<div>"),t.$margin=$("<div>"),t.getContentHeight=function(){var n=this.find(".header"),e=this.find(".footer"),t=Math.max(n.length>0?n.height():0,parseInt(this.$margin.css("margin-top"))),a=Math.max(e.length>0?e.height():0,parseInt(this.$margin.css("margin-top")));return this.height()-t-a},t.needsBreaking=function(){return this.$content.height()>this.getContentHeight()},t.conditionallyAppendHeader=function(){var e;if(e=n.$$model.find(".header"),e.length>0){if(e=e.eq(e.length>1?n._lastPageNumber%e.length:0).clone(!0,!0),e.hasClass("terminal")&&1!==n._lastPageNumber)return;e.children().wrapAll('<div class="margin">'),this.append(e),setTimeout(function(){t.$content.css("margin-top",e.height())})}},t.conditionallyAppendFooter=function(){var e;if(e=n.$$model.find(".footer"),e.length>0){if(e=e.eq(e.length>1?n._lastPageNumber%e.length:0).clone(!0,!0),e.hasClass("terminal")&&1!==n._lastPageNumber)return;e.children().wrapAll('<div class="margin">'),this.append(e),setTimeout(function(){t.$content.css("margin-bottom",e.height())})}},t.isBlank=function(){return this.$margin.children().length<1},t.data("pageNumber",e),t.addClass("page"),t.$content.addClass("content"),t.$margin.addClass("margin"),t.$content.append(t.$margin),t.conditionallyAppendHeader(n),t.conditionallyAppendFooter(n),t.append(t.$content),t}}(),function(){Paginator.Model=function(n){function e(n){n.children().each(function(){e($(this).addClass("-model"))})}var t;return t=$("<div>"),t.addClass("model"),n.children().each(function(){var n=$(this);n.filter(".content").children().each(function(){var n=$(this);e(n)}),t.append(n)}),n.append(t),t}}(),function(){Paginator.View=function(n){var e;return e=$("<div>"),e.addClass("view"),n.append(e),e}}(),function(){Paginator.Component=function(n,e){return n.addClass("paginator"),n.data("settings",new Paginator.Settings(e||{})),n.$$model=new Paginator.Model(n),n.$$view=new Paginator.View(n),n._renderer=new Paginator.Renderer(n),n._lastPageNumber=0,n.$$model.on("DOMSubtreeModified",function(){n.$$model.imagesLoaded().always(function(){n.data("isRendering")||n._renderer.render()})}),n.$$model.imagesLoaded().always(function(){n._renderer.render()}),n}}(),function(){$.fn.paginate=function(n){this.each(function(){new Paginator.Component($(this),n)})}}();